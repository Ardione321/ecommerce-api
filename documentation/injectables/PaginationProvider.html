<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ecommerce-api documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avaoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);

               if ($darkModeToggles.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-block d-sm-none">
            <a href="../" class="navbar-brand">ecommerce-api documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >PaginationProvider</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/common/pagination/providers/pagination.provider.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#paginateQuery" >paginateQuery</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(request: FastifyRequest)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="8" class="link-to-prism">src/common/pagination/providers/pagination.provider.ts:8</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>request</td>
                                                  
                                                        <td>
                                                                    <code>FastifyRequest</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="paginateQuery"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>paginateQuery</b></span>
                        <a href="#paginateQuery"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>paginateQuery(paginationQuery: <a href="../classes/PaginationQueryDto.html" target="_self">PaginationQueryDto</a>, repository: Repository<T>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="38"
                                    class="link-to-prism">src/common/pagination/providers/pagination.provider.ts:38</a></div>
                        </td>
                    </tr>

                    <tr>
                        <td class="col-md-4">
                            <b>Type parameters :</b>
                            <ul class="type-parameters">
                                    <li>T</li>
                            </ul>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Paginates a query using the provided repository and pagination query DTO.
Returns a Paginated<T> object containing the paginated data and metadata.</p>
<p>This function takes a pagination query and a repository as parameters.
It uses the skip and take methods of the repository to paginate the query.
The page and limit parameters are used to calculate the offset and limit
of the query. The offset is used to skip over the number of items
specified by the page parameter, and the limit is used to limit the
number of items returned.</p>
<p>The function also calculates the total number of pages and the next and
previous page numbers based on the total number of items and the current
page number.</p>
<p>Finally, the function returns a Paginated<T> object containing the
paginated data and metadata. The metadata includes the items per page,
total items, current page, total pages, and links to the first, last,
current, next, and previous pages.</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>paginationQuery</td>
                                            <td>
                                                            <code><a href="../classes/PaginationQueryDto.html" target="_self" >PaginationQueryDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The pagination query to use.</li>
</ul>

                                            </td>
                                        </tr>
                                        <tr>
                                                <td>repository</td>
                                            <td>
                                                        <code>Repository&lt;T&gt;</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The repository to paginate.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../interfaces/Paginated.html" target="_self" >Promise&lt;Paginated&lt;T&gt;&gt;</a></code>

                        </div>
                            <div class="io-description">
                                <p>A Paginated<T> object containing the paginated data and metadata.</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Inject, Injectable } from &quot;@nestjs/common&quot;;
import { FastifyRequest } from &#x27;fastify&#x27;;
import { ObjectLiteral, Repository } from &quot;typeorm&quot;;
import { PaginationQueryDto } from &quot;../dtos/pagination-query.dto&quot;;
import { Paginated } from &quot;../interfaces/pagination.interface&quot;;
import { REQUEST } from &quot;@nestjs/core&quot;;
@Injectable()
export class PaginationProvider {
    constructor(
        @Inject(REQUEST)
        private readonly request: FastifyRequest, 
    ) {}

    /**
     * Paginates a query using the provided repository and pagination query DTO.
     * Returns a Paginated&lt;T&gt; object containing the paginated data and metadata.
     *
     * This function takes a pagination query and a repository as parameters.
     * It uses the skip and take methods of the repository to paginate the query.
     * The page and limit parameters are used to calculate the offset and limit
     * of the query. The offset is used to skip over the number of items
     * specified by the page parameter, and the limit is used to limit the
     * number of items returned.
     *
     * The function also calculates the total number of pages and the next and
     * previous page numbers based on the total number of items and the current
     * page number.
     *
     * Finally, the function returns a Paginated&lt;T&gt; object containing the
     * paginated data and metadata. The metadata includes the items per page,
     * total items, current page, total pages, and links to the first, last,
     * current, next, and previous pages.
     *
     * @param paginationQuery - The pagination query to use.
     * @param repository - The repository to paginate.
     * @returns A Paginated&lt;T&gt; object containing the paginated data and metadata.
     */
    public async paginateQuery&lt;T extends ObjectLiteral&gt;(paginationQuery: PaginationQueryDto, repository: Repository&lt;T&gt;): Promise&lt;Paginated&lt;T&gt;&gt; {
        // Get the page and limit parameters from the pagination query.
        const { page, limit } &#x3D; paginationQuery;
        // Calculate the offset based on the page number and limit.
        const offset &#x3D; (page - 1) * limit;

        // Execute the query using the skip and take methods of the repository.
        const [data, totalItems] &#x3D; await repository.findAndCount({ skip: offset, take: limit });

        // Calculate the total number of pages based on the total number of items and the limit.
        const totalPages &#x3D; Math.ceil(totalItems / limit);
        // Calculate the next and previous page numbers based on the current page number.
        const nextPage &#x3D; page &lt; totalPages ? page + 1 : totalPages;
        const previousPage &#x3D; page &gt; 1 ? page - 1 : 1;

        // Create a new URL object from the request URL.
        const baseUrl &#x3D; &#x60;${this.request.protocol}://${this.request.hostname}&#x60;;
        const requestUrl &#x3D; new URL(this.request.url, baseUrl);

        // Return a Paginated&lt;T&gt; object containing the paginated data and metadata.
        return {
            // The paginated data.
            data,
            // The metadata.
            meta: {
                // The number of items per page.
                itemsPerPage: limit,
                // The total number of items.
                totalItems,
                // The current page number.
                currentPage: page,
                // The total number of pages.
                totalPages,
            },
            // The links to the first, last, current, next, and previous pages.
            links: {
                // The URL of the first page.
                first: &#x60;${requestUrl.origin}${requestUrl.pathname}?limit&#x3D;${limit}&amp;page&#x3D;1&#x60;,
                // The URL of the last page.
                last: &#x60;${requestUrl.origin}${requestUrl.pathname}?limit&#x3D;${limit}&amp;page&#x3D;${totalPages}&#x60;,
                // The URL of the current page.
                current: &#x60;${requestUrl.origin}${requestUrl.pathname}?limit&#x3D;${limit}&amp;page&#x3D;${page}&#x60;,
                // The URL of the next page.
                next: &#x60;${requestUrl.origin}${requestUrl.pathname}?limit&#x3D;${limit}&amp;page&#x3D;${nextPage}&#x60;,
                // The URL of the previous page.
                previous: &#x60;${requestUrl.origin}${requestUrl.pathname}?limit&#x3D;${limit}&amp;page&#x3D;${previousPage}&#x60;,
            },
        };
    };
}
</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'PaginationProvider.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
